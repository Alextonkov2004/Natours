{"mappings":"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","sources":["<anon>","public/js/index.js","public/js/login.js","public/js/alerts.js","public/js/updateSettings.js","public/js/stripe.js","public/js/signup.js","public/js/mapbox.js"],"sourcesContent":["(function () {\n/* eslint-disable */ /* eslint-disable */ /* eslint-disable */ const $603090f3879398fd$export$516836c6a9dfc573 = ()=>{\n    const el = document.querySelector(\".alert\");\n    if (el) el.parentElement.removeChild(el);\n};\nconst $603090f3879398fd$export$de026b00723010c1 = (type, msg, time = 7)=>{\n    $603090f3879398fd$export$516836c6a9dfc573();\n    const markup = `<div class=\"alert alert--${type}\">${msg}</div`;\n    document.querySelector(\"body\").insertAdjacentHTML(\"afterbegin\", markup);\n    window.setTimeout($603090f3879398fd$export$516836c6a9dfc573, time * 1000);\n};\n\n\nconst $94050a3fc3bfdbcd$export$596d806903d1f59e = async (email, password)=>{\n    try {\n        const res = await axios({\n            method: \"POST\",\n            url: \"/api/v1/users/login\",\n            data: {\n                email: email,\n                password: password\n            }\n        });\n        if (res.data.status === \"success\") {\n            (0, $603090f3879398fd$export$de026b00723010c1)(\"success\", \"Logged in successfully!\");\n            window.setTimeout(()=>{\n                location.assign(\"/\");\n            }, 1500);\n        }\n    } catch (err) {\n        (0, $603090f3879398fd$export$de026b00723010c1)(\"error\", err.response.data.message);\n    }\n};\nconst $94050a3fc3bfdbcd$export$a0973bcfe11b05c9 = async ()=>{\n    try {\n        const res = await axios({\n            method: \"GET\",\n            url: \"/api/v1/users/logout\"\n        });\n        if (res.data.status === \"success\") window.setTimeout(()=>{\n            location.assign(\"/\");\n        }, 1500);\n    } catch (err) {\n        (0, $603090f3879398fd$export$de026b00723010c1)(\"error\", \"Error logging out! Try again!\");\n    }\n};\n\n\n/* eslint-disable */ \nconst $1f5a7c61e036ce0a$export$f558026a994b6051 = async (data, type)=>{\n    try {\n        const url = type === \"password\" ? \"/api/v1/users/updateMyPassword\" : \"/api/v1/users/updateMe\";\n        const res = await axios({\n            method: \"PATCH\",\n            url: url,\n            data: data\n        });\n        if (res.data.status === \"success\") (0, $603090f3879398fd$export$de026b00723010c1)(\"success\", `${type.toUpperCase()} updated succesfully!`);\n    } catch (err) {\n        (0, $603090f3879398fd$export$de026b00723010c1)(\"error\", err.response.data.message);\n    }\n};\n\n\n/*eslint-disable */ \nconst $aefb8e14666a3e2b$export$8d5bdbf26681c0c2 = async (tourId)=>{\n    try {\n        //1) Get checkout session from api\n        const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\n        //console.log(session);\n        //2) Create checkout form + charge credit card\n        window.location.replace(session.data.session.url);\n    } catch (err) {\n        (0, $603090f3879398fd$export$de026b00723010c1)(\"error\", err);\n    }\n};\n\n\n/*eslint-disable */ \nconst $f2c5880e21f45671$export$7200a869094fec36 = async (name, email, password, passwordConfirm)=>{\n    try {\n        const res = await axios({\n            method: \"POST\",\n            url: \"/api/v1/users/signup\",\n            data: {\n                name: name,\n                email: email,\n                password: password,\n                passwordConfirm: passwordConfirm\n            }\n        });\n        if (res.data.status === \"success\") {\n            (0, $603090f3879398fd$export$de026b00723010c1)(\"success\", \"Signed up successfully\");\n            window.setTimeout(()=>{\n                location.assign(\"/\");\n            }, 1500);\n        }\n    } catch (err) {\n        console.log(err);\n        const errMsg = err.response.data.message.split(\".\");\n        if (errMsg[0].startsWith(\"Duplicate\")) {\n            const errMsgSplit = errMsg[0].split(\":\");\n            const message = errMsgSplit[1] === \" undefined\" ? \"Email is already in use\" : `${errMsg[0].split(\":\")[1]} is already in use.`;\n            (0, $603090f3879398fd$export$de026b00723010c1)(\"error\", message);\n        } else if (errMsg[0].startsWith(\"Invalid\")) (0, $603090f3879398fd$export$de026b00723010c1)(\"error\", err.response.data.message);\n        else (0, $603090f3879398fd$export$de026b00723010c1)(\"error\", err.response.data.message);\n    }\n};\n\n\n/*eslint-disable*/ const $2f46cdb1c1d48b76$export$4c5dd147b21b9176 = (locations, startLocation, mapToken)=>{\n    locations.push(startLocation);\n    mapboxgl.accessToken = mapToken;\n    var map = new mapboxgl.Map({\n        container: \"map\",\n        style: \"mapbox://styles/alextonkov2004/cly05dy6g003a01qp56vu0fxt\",\n        //center: [-118.155614, 33.976076],\n        //zoom: 1,\n        //interactive: true\n        scrollZoom: false\n    });\n    map.on(\"style.load\", ()=>{\n        map.setFog({});\n    });\n    const bounds = new mapboxgl.LngLatBounds();\n    locations.forEach((loc)=>{\n        const [lng, lat] = loc.coordinates;\n        //Create marker\n        const el = document.createElement(\"div\");\n        loc.day === undefined ? el.className = \"marker-orange\" : el.className = \"marker\";\n        let paragraph;\n        loc.day === undefined ? paragraph = `<p>Start: ${loc.address}</p>` : paragraph = `<p>Day ${loc.day}: ${loc.description}</p>`;\n        //Add Pop up\n        const popUp = new mapboxgl.Popup({\n            offset: 30,\n            closeButton: false,\n            closeOnClick: false\n        }).setHTML(paragraph);\n        //Add marker\n        const marker = new mapboxgl.Marker({\n            element: el,\n            anchor: \"bottom\"\n        }).setLngLat(loc.coordinates).setPopup(popUp).addTo(map);\n        const markerDiv = marker.getElement();\n        markerDiv.addEventListener(\"mouseenter\", ()=>marker.togglePopup());\n        markerDiv.addEventListener(\"mouseleave\", ()=>marker.togglePopup());\n        // Extends map bounds to include current location\n        bounds.extend([\n            lng,\n            lat\n        ]);\n    });\n    map.fitBounds(bounds, {\n        padding: {\n            top: 200,\n            bottom: 200,\n            left: 100,\n            right: 100\n        }\n    });\n};\n\n\n\n//DOM elements\nconst $75f8cdcb12ac9fc7$var$elMap = document.getElementById(\"map\");\nconst $75f8cdcb12ac9fc7$var$loginForm = document.querySelector(\"form.form--login\");\nconst $75f8cdcb12ac9fc7$var$logoutBtn = document.querySelector(\".nav__el--logout\");\nconst $75f8cdcb12ac9fc7$var$userPasswordForm = document.querySelector(\".form.form-user-password\");\nconst $75f8cdcb12ac9fc7$var$userDataForm = document.querySelector(\".form.form-user-data\");\nconst $75f8cdcb12ac9fc7$var$bookBtn = document.getElementById(\"book-tour\");\nconst $75f8cdcb12ac9fc7$var$signupForm = document.querySelector(\"form.form--signup\");\nif ($75f8cdcb12ac9fc7$var$elMap) {\n    const locations = JSON.parse($75f8cdcb12ac9fc7$var$elMap.dataset.locations);\n    const startLocation = JSON.parse($75f8cdcb12ac9fc7$var$elMap.dataset.startLocation);\n    const mapToken = $75f8cdcb12ac9fc7$var$elMap.dataset.mapToken;\n    (0, $2f46cdb1c1d48b76$export$4c5dd147b21b9176)(locations, startLocation, mapToken);\n}\nif ($75f8cdcb12ac9fc7$var$loginForm) $75f8cdcb12ac9fc7$var$loginForm.addEventListener(\"submit\", (e)=>{\n    e.preventDefault();\n    const email = document.getElementById(\"email\").value;\n    const password = document.getElementById(\"password\").value;\n    (0, $94050a3fc3bfdbcd$export$596d806903d1f59e)(email, password);\n});\nif ($75f8cdcb12ac9fc7$var$signupForm) $75f8cdcb12ac9fc7$var$signupForm.addEventListener(\"submit\", (e)=>{\n    e.preventDefault();\n    const name = document.getElementById(\"name\").value;\n    const email = document.getElementById(\"email\").value;\n    const password = document.getElementById(\"password\").value;\n    const passwordConfirm = document.getElementById(\"password-confirm\").value;\n    (0, $f2c5880e21f45671$export$7200a869094fec36)(name, email, password, passwordConfirm);\n});\nif ($75f8cdcb12ac9fc7$var$logoutBtn) $75f8cdcb12ac9fc7$var$logoutBtn.addEventListener(\"click\", (0, $94050a3fc3bfdbcd$export$a0973bcfe11b05c9));\nif ($75f8cdcb12ac9fc7$var$userDataForm) $75f8cdcb12ac9fc7$var$userDataForm.addEventListener(\"submit\", (e)=>{\n    e.preventDefault();\n    const form = new FormData();\n    form.append(\"name\", document.getElementById(\"name\").value);\n    form.append(\"email\", document.getElementById(\"email\").value);\n    form.append(\"photo\", document.getElementById(\"photo\").files[0]);\n    (0, $1f5a7c61e036ce0a$export$f558026a994b6051)(form, \"data\");\n});\nif ($75f8cdcb12ac9fc7$var$userPasswordForm) $75f8cdcb12ac9fc7$var$userPasswordForm.addEventListener(\"submit\", async (e)=>{\n    e.preventDefault();\n    document.querySelector(\".btn--save-password\").textContent = \"Updating...\";\n    const currentPassword = document.getElementById(\"password-current\").value;\n    const password = document.getElementById(\"password\").value;\n    const passwordConfirm = document.getElementById(\"password-confirm\").value;\n    await (0, $1f5a7c61e036ce0a$export$f558026a994b6051)({\n        currentPassword: currentPassword,\n        password: password,\n        passwordConfirm: passwordConfirm\n    }, \"password\");\n    document.querySelector(\".btn--save-password\").textContent = \"Save password\";\n    document.getElementById(\"password-current\").value = \"\";\n    document.getElementById(\"password\").value = \"\";\n    document.getElementById(\"password-confirm\").value = \"\";\n});\nif ($75f8cdcb12ac9fc7$var$bookBtn) $75f8cdcb12ac9fc7$var$bookBtn.addEventListener(\"click\", (e)=>{\n    e.target.textContent = \"Processing...\";\n    const { tourId: tourId } = e.target.dataset;\n    (0, $aefb8e14666a3e2b$export$8d5bdbf26681c0c2)(tourId);\n});\nconst $75f8cdcb12ac9fc7$var$alertMessage = document.querySeelector(\"body\").dataset.alert;\nif ($75f8cdcb12ac9fc7$var$alertMessage) (0, $603090f3879398fd$export$de026b00723010c1)(\"success\", $75f8cdcb12ac9fc7$var$alertMessage, 20);\n\n})();\n//# sourceMappingURL=index.js.map\n","/* eslint-disable */\r\nimport { login, logout } from './login';\r\nimport { updateSettings } from './updateSettings';\r\nimport { bookTour } from './stripe';\r\nimport { signup } from './signup';\r\nimport { displayMap } from './mapbox';\r\nimport { showAlert } from './alerts';\r\n\r\n//DOM elements\r\nconst elMap = document.getElementById('map');\r\nconst loginForm = document.querySelector('form.form--login');\r\nconst logoutBtn = document.querySelector('.nav__el--logout');\r\nconst userPasswordForm = document.querySelector('.form.form-user-password');\r\nconst userDataForm = document.querySelector('.form.form-user-data');\r\nconst bookBtn = document.getElementById('book-tour');\r\nconst signupForm = document.querySelector('form.form--signup');\r\n\r\nif (elMap) {\r\n  const locations = JSON.parse(elMap.dataset.locations);\r\n  const startLocation = JSON.parse(elMap.dataset.startLocation);\r\n  const mapToken = elMap.dataset.mapToken;\r\n  displayMap(locations, startLocation, mapToken);\r\n}\r\n\r\nif (loginForm) {\r\n  loginForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    login(email, password);\r\n  });\r\n}\r\nif (signupForm) {\r\n  signupForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const name = document.getElementById('name').value;\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    const passwordConfirm = document.getElementById('password-confirm').value;\r\n    signup(name, email, password, passwordConfirm);\r\n  });\r\n}\r\n\r\nif (logoutBtn) {\r\n  logoutBtn.addEventListener('click', logout);\r\n}\r\n\r\nif (userDataForm) {\r\n  userDataForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const form = new FormData();\r\n    form.append('name', document.getElementById('name').value);\r\n    form.append('email', document.getElementById('email').value);\r\n    form.append('photo', document.getElementById('photo').files[0]);\r\n\r\n    updateSettings(form, 'data');\r\n  });\r\n}\r\n\r\nif (userPasswordForm) {\r\n  userPasswordForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n    const currentPassword = document.getElementById('password-current').value;\r\n    const password = document.getElementById('password').value;\r\n    const passwordConfirm = document.getElementById('password-confirm').value;\r\n    await updateSettings(\r\n      { currentPassword, password, passwordConfirm },\r\n      'password',\r\n    );\r\n\r\n    document.querySelector('.btn--save-password').textContent = 'Save password';\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n  });\r\n}\r\n\r\nif (bookBtn) {\r\n  bookBtn.addEventListener('click', (e) => {\r\n    e.target.textContent = 'Processing...';\r\n    const { tourId } = e.target.dataset;\r\n    bookTour(tourId);\r\n  });\r\n}\r\n\r\nconst alertMessage = document.querySeelector('body').dataset.alert\r\nif(alertMessage) showAlert('success', alertMessage, 20)","/* eslint-disable */\r\nimport { showAlert } from './alerts';\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully!');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: '/api/v1/users/logout',\r\n    });\r\n    if (res.data.status === 'success') {\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', 'Error logging out! Try again!');\r\n  }\r\n};\r\n","/* eslint-disable */\r\nexport const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\nexport const showAlert = (type, msg, time = 7) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, time * 1000);\r\n};\r\n","/* eslint-disable */\r\nimport { showAlert } from './alerts';\r\n\r\nexport const updateSettings = async (data, type) => {\r\n  try {\r\n    const url =\r\n      type === 'password'\r\n        ? '/api/v1/users/updateMyPassword'\r\n        : '/api/v1/users/updateMe';\r\n\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url,\r\n      data,\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', `${type.toUpperCase()} updated succesfully!`);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n","/*eslint-disable */\r\nimport { showAlert } from './alerts';\r\n\r\nexport const bookTour = async (tourId) => {\r\n  try {\r\n    //1) Get checkout session from api\r\n    const session = await axios(\r\n      `/api/v1/bookings/checkout-session/${tourId}`,\r\n    );\r\n\r\n    //console.log(session);\r\n    //2) Create checkout form + charge credit card\r\n\r\n    window.location.replace(session.data.session.url);\r\n  } catch (err) {\r\n    showAlert('error', err);\r\n  }\r\n};\r\n","/*eslint-disable */\r\n\r\nimport { showAlert } from './alerts';\r\n\r\nexport const signup = async (name, email, password, passwordConfirm) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/signup',\r\n      data: {\r\n        name,\r\n        email,\r\n        password,\r\n        passwordConfirm,\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Signed up successfully');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n   console.log(err);\r\n    const errMsg = err.response.data.message.split('.');\r\n    if (errMsg[0].startsWith('Duplicate')) {\r\n      const errMsgSplit = errMsg[0].split(':')\r\n      const message = errMsgSplit[1] === ' undefined'? 'Email is already in use':`${errMsg[0].split(':')[1]} is already in use.`;\r\n      showAlert('error', message);\r\n    } else if (errMsg[0].startsWith('Invalid')) {\r\n      showAlert('error', err.response.data.message);\r\n    } else showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n","/*eslint-disable*/\r\n\r\nexport const displayMap = (locations, startLocation, mapToken) => {\r\n  locations.push(startLocation);\r\n  mapboxgl.accessToken = mapToken;\r\n  var map = new mapboxgl.Map({\r\n    container: 'map',\r\n    style: 'mapbox://styles/alextonkov2004/cly05dy6g003a01qp56vu0fxt',\r\n    //center: [-118.155614, 33.976076],\r\n    //zoom: 1,\r\n    //interactive: true\r\n    scrollZoom: false,\r\n  });\r\n  map.on('style.load', () => {\r\n    map.setFog({});\r\n  });\r\n  const bounds = new mapboxgl.LngLatBounds();\r\n\r\n  locations.forEach((loc) => {\r\n    const [lng, lat] = loc.coordinates;\r\n    //Create marker\r\n    const el = document.createElement('div');\r\n    loc.day === undefined\r\n      ? (el.className = 'marker-orange')\r\n      : (el.className = 'marker');\r\n    let paragraph;\r\n    loc.day === undefined\r\n      ? (paragraph = `<p>Start: ${loc.address}</p>`)\r\n      : (paragraph = `<p>Day ${loc.day}: ${loc.description}</p>`);\r\n\r\n    //Add Pop up\r\n    const popUp = new mapboxgl.Popup({\r\n      offset: 30,\r\n      closeButton: false,\r\n      closeOnClick: false,\r\n    }).setHTML(paragraph);\r\n\r\n    //Add marker\r\n    const marker = new mapboxgl.Marker({\r\n      element: el,\r\n      anchor: 'bottom',\r\n    })\r\n      .setLngLat(loc.coordinates)\r\n      .setPopup(popUp)\r\n      .addTo(map);\r\n\r\n    const markerDiv = marker.getElement();\r\n    markerDiv.addEventListener('mouseenter', () => marker.togglePopup());\r\n    markerDiv.addEventListener('mouseleave', () => marker.togglePopup());\r\n    // Extends map bounds to include current location\r\n    bounds.extend([lng, lat]);\r\n  });\r\n\r\n  map.fitBounds(bounds, {\r\n    padding: {\r\n      top: 200,\r\n      bottom: 200,\r\n      left: 100,\r\n      right: 100,\r\n    },\r\n  });\r\n};\r\n"],"names":["$603090f3879398fd$export$516836c6a9dfc573","el","document","querySelector","parentElement","removeChild","$603090f3879398fd$export$de026b00723010c1","type","msg","time","markup","insertAdjacentHTML","window","setTimeout","$94050a3fc3bfdbcd$export$596d806903d1f59e","email","password","res","axios","method","url","data","status","location","assign","err","response","message","$94050a3fc3bfdbcd$export$a0973bcfe11b05c9","$1f5a7c61e036ce0a$export$f558026a994b6051","toUpperCase","$aefb8e14666a3e2b$export$8d5bdbf26681c0c2","tourId","session","replace","$f2c5880e21f45671$export$7200a869094fec36","name","passwordConfirm","console","log","errMsg","split","startsWith","errMsgSplit","$75f8cdcb12ac9fc7$var$elMap","getElementById","$75f8cdcb12ac9fc7$var$loginForm","$75f8cdcb12ac9fc7$var$logoutBtn","$75f8cdcb12ac9fc7$var$userPasswordForm","$75f8cdcb12ac9fc7$var$userDataForm","$75f8cdcb12ac9fc7$var$bookBtn","$75f8cdcb12ac9fc7$var$signupForm","locations","startLocation","mapToken","push","mapboxgl","accessToken","map","Map","container","style","scrollZoom","on","setFog","bounds","LngLatBounds","forEach","loc","paragraph","lng","lat","coordinates","createElement","undefined","day","className","address","description","popUp","Popup","offset","closeButton","closeOnClick","setHTML","marker","Marker","element","anchor","setLngLat","setPopup","addTo","markerDiv","getElement","addEventListener","togglePopup","extend","fitBounds","padding","top","bottom","left","right","JSON","parse","dataset","e","preventDefault","value","form","FormData","append","files","textContent","currentPassword","target","$75f8cdcb12ac9fc7$var$alertMessage","querySeelector","alert","login","logout","updateSettings","bookTour","signup","displayMap","showAlert","elMap","loginForm","logoutBtn","userPasswordForm","userDataForm","bookBtn","signupForm","alertMessage","hideAlert"],"version":3,"file":"index.js.map"}